<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Tracker - MindTrack</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1>MindTrack</h1>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="mood-tracker.html" class="active">Mood Tracker</a></li>
                    <li><a href="resources.html">Resources</a></li>
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <section class="mood-tracker">
        <div class="container">
            <div class="page-header">
                <h1>Mood Tracker</h1>
                <p>Track your moods and emotions to gain insights into your mental wellbeing.</p>
            </div>

            <div class="tracker-grid">
                <div class="tracker-card mood-history-card">
                    <h2>Mood History</h2>
                    <div class="chart-container">
                        <canvas id="moodHistoryChart"></canvas>
                    </div>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: rgba(75, 192, 192, 1)"></span>
                            <span>Mood Level</span>
                        </div>
                    </div>
                </div>

                <div class="tracker-card mood-calendar-card">
                    <h2>Mood Calendar</h2>
                    <div class="calendar-header">
                        <button id="prev-month" class="btn-icon"><i class="fas fa-chevron-left"></i></button>
                        <h3 id="calendar-month">March 2023</h3>
                        <button id="next-month" class="btn-icon"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar will be generated by JavaScript -->
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item">
                            <span class="mood-dot" style="background-color: #e74c3c"></span>
                            <span>Bad</span>
                        </div>
                        <div class="legend-item">
                            <span class="mood-dot" style="background-color: #f39c12"></span>
                            <span>Low</span>
                        </div>
                        <div class="legend-item">
                            <span class="mood-dot" style="background-color: #f1c40f"></span>
                            <span>Okay</span>
                        </div>
                        <div class="legend-item">
                            <span class="mood-dot" style="background-color: #2ecc71"></span>
                            <span>Good</span>
                        </div>
                        <div class="legend-item">
                            <span class="mood-dot" style="background-color: #27ae60"></span>
                            <span>Great</span>
                        </div>
                    </div>
                </div>

                <div class="tracker-card journal-entry-card">
                    <h2>Journal Entry</h2>
                    <div class="journal-form">
                        <div class="form-group">
                            <label for="entry-date">Date</label>
                            <input type="date" id="entry-date" value="">
                        </div>
                        <div class="form-group">
                            <label>How are you feeling today?</label>
                            <div class="mood-selector">
                                <div class="mood-option" data-mood="5">
                                    <div class="mood-emoji">üòÑ</div>
                                    <p>Great</p>
                                </div>
                                <div class="mood-option" data-mood="4">
                                    <div class="mood-emoji">üôÇ</div>
                                    <p>Good</p>
                                </div>
                                <div class="mood-option" data-mood="3">
                                    <div class="mood-emoji">üòê</div>
                                    <p>Okay</p>
                                </div>
                                <div class="mood-option" data-mood="2">
                                    <div class="mood-emoji">üôÅ</div>
                                    <p>Low</p>
                                </div>
                                <div class="mood-option" data-mood="1">
                                    <div class="mood-emoji">üòû</div>
                                    <p>Bad</p>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="entry-title">Title (optional)</label>
                            <input type="text" id="entry-title" placeholder="Give your entry a title">
                        </div>
                        <div class="form-group">
                            <label for="entry-content">Journal Entry</label>
                            <textarea id="entry-content" rows="6" placeholder="Write about your day, feelings, thoughts..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>What factors affected your mood today?</label>
                            <div class="factors-grid">
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-sleep">
                                    <label for="factor-sleep">Sleep</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-exercise">
                                    <label for="factor-exercise">Exercise</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-nutrition">
                                    <label for="factor-nutrition">Nutrition</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-social">
                                    <label for="factor-social">Social</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-work">
                                    <label for="factor-work">Work</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-health">
                                    <label for="factor-health">Health</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-weather">
                                    <label for="factor-weather">Weather  id="factor-weather">
                                    <label for="factor-weather">Weather</label>
                                </div>
                                <div class="factor-checkbox">
                                    <input type="checkbox" id="factor-stress">
                                    <label for="factor-stress">Stress</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-secondary" id="clear-entry">Clear</button>
                            <button class="btn btn-primary" id="save-entry">Save Entry</button>
                        </div>
                    </div>
                </div>

                <div class="tracker-card journal-list-card">
                    <h2>Journal History</h2>
                    <div class="journal-list" id="journal-list">
                        <!-- Journal entries will be populated by JavaScript -->
                    </div>
                </div>

                <div class="tracker-card insights-card">
                    <h2>Mood Insights</h2>
                    <div class="insights-content">
                        <div class="insight-item">
                            <h3>Mood Patterns</h3>
                            <p id="mood-pattern-insight">Based on your entries, your mood tends to be higher on weekends and lower on Mondays.</p>
                        </div>
                        <div class="insight-item">
                            <h3>Common Factors</h3>
                            <div class="factors-chart-container">
                                <canvas id="factorsChart"></canvas>
                            </div>
                        </div>
                        <div class="insight-item">
                            <h3>Recommendations</h3>
                            <ul id="recommendations-list">
                                <li>Consider prioritizing sleep as it appears to positively impact your mood.</li>
                                <li>Your mood seems to improve with social activities.</li>
                                <li>Work stress appears to be a common factor on low mood days.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2>MindTrack</h2>
                    <p>Your mental health companion</p>
                </div>
                <div class="footer-links">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="dashboard.html">Dashboard</a></li>
                        <li><a href="mood-tracker.html">Mood Tracker</a></li>
                        <li><a href="resources.html">Resources</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3>Support</h3>
                    <ul>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-newsletter">
                    <h3>Stay Updated</h3>
                    <p>Subscribe to our newsletter for mental health tips and updates.</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Your email address">
                        <button type="submit" class="btn btn-primary">Subscribe</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 MindTrack. All rights reserved.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default for journal entry
            const today = new Date();
            document.getElementById('entry-date').value = today.toISOString().split('T')[0];
            
            // Initialize mood history chart
            const moodData = JSON.parse(localStorage.getItem('moodData')) || { dates: [], values: [] };
            const ctx = document.getElementById('moodHistoryChart').getContext('2d');
            
            const moodHistoryChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: moodData.dates,
                    datasets: [{
                        label: 'Mood Level',
                        data: moodData.values,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                        pointRadius: 4
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    const labels = ['', 'Bad', 'Low', 'Okay', 'Good', 'Great'];
                                    return labels[value];
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // Initialize factors chart
            const factorsCtx = document.getElementById('factorsChart').getContext('2d');
            const factorsData = {
                labels: ['Sleep', 'Exercise', 'Nutrition', 'Social', 'Work', 'Health', 'Weather', 'Stress'],
                datasets: [{
                    label: 'Impact on Mood',
                    data: [4.2, 3.8, 3.5, 4.0, 2.5, 3.0, 2.8, 2.2],
                    backgroundColor: [
                        'rgba(75, 192, 192, 0.6)',
                        'rgba(54, 162, 235, 0.6)',
                        'rgba(255, 206, 86, 0.6)',
                        'rgba(75, 192, 192, 0.6)',
                        'rgba(153, 102, 255, 0.6)',
                        'rgba(255, 159, 64, 0.6)',
                        'rgba(255, 99, 132, 0.6)',
                        'rgba(199, 199, 199, 0.6)'
                    ],
                    borderColor: [
                        'rgba(75, 192, 192, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)',
                        'rgba(255, 99, 132, 1)',
                        'rgba(199, 199, 199, 1)'
                    ],
                    borderWidth: 1
                }]
            };
            
            const factorsChart = new Chart(factorsCtx, {
                type: 'bar',
                data: factorsData,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // Handle mood selection
            const moodOptions = document.querySelectorAll('.mood-option');
            let selectedMood = null;
            
            moodOptions.forEach(option => {
                option.addEventListener('click', function() {
                    moodOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedMood = parseInt(this.dataset.mood);
                });
            });
            
            // Handle journal entry saving
            document.getElementById('save-entry').addEventListener('click', function() {
                if (selectedMood === null) {
                    alert('Please select a mood before saving your entry.');
                    return;
                }
                
                const entryDate = document.getElementById('entry-date').value;
                const entryTitle = document.getElementById('entry-title').value || `Journal Entry - ${entryDate}`;
                const entryContent = document.getElementById('entry-content').value;
                
                if (!entryContent.trim()) {
                    alert('Please write something in your journal entry.');
                    return;
                }
                
                // Get selected factors
                const factors = [];
                document.querySelectorAll('.factor-checkbox input:checked').forEach(checkbox => {
                    factors.push(checkbox.id.replace('factor-', ''));
                });
                
                // Save journal entry
                const journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                journalEntries.unshift({
                    date: entryDate,
                    title: entryTitle,
                    mood: selectedMood,
                    content: entryContent,
                    factors: factors
                });
                localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
                
                // Update mood data
                const moodData = JSON.parse(localStorage.getItem('moodData')) || {
                    dates: [],
                    values: []
                };
                
                // Check if we already have an entry for this date
                const dateIndex = moodData.dates.indexOf(entryDate);
                if (dateIndex !== -1) {
                    moodData.values[dateIndex] = selectedMood;
                } else {
                    // Find the correct position to insert the new date (to maintain chronological order)
                    let insertIndex = moodData.dates.length;
                    for (let i = 0; i < moodData.dates.length; i++) {
                        if (entryDate < moodData.dates[i]) {
                            insertIndex = i;
                            break;
                        }
                    }
                    
                    moodData.dates.splice(insertIndex, 0, entryDate);
                    moodData.values.splice(insertIndex, 0, selectedMood);
                }
                
                localStorage.setItem('moodData', JSON.stringify(moodData));
                
                // Update charts and displays
                updateJournalList();
                updateCalendar();
                
                // Update mood history chart
                moodHistoryChart.data.labels = moodData.dates;
                moodHistoryChart.data.datasets[0].data = moodData.values;
                moodHistoryChart.update();
                
                // Reset form
                document.getElementById('entry-title').value = '';
                document.getElementById('entry-content').value = '';
                document.querySelectorAll('.factor-checkbox input').forEach(checkbox => {
                    checkbox.checked = false;
                });
                moodOptions.forEach(opt => opt.classList.remove('selected'));
                selectedMood = null;
                
                alert('Journal entry saved successfully!');
            });
            
            // Handle clear button
            document.getElementById('clear-entry').addEventListener('click', function() {
                document.getElementById('entry-title').value = '';
                document.getElementById('entry-content').value = '';
                document.querySelectorAll('.factor-checkbox input').forEach(checkbox => {
                    checkbox.checked = false;
                });
                moodOptions.forEach(opt => opt.classList.remove('selected'));
                selectedMood = null;
            });
            
            // Initialize journal list
            function updateJournalList() {
                const journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                const journalList = document.getElementById('journal-list');
                
                if (journalEntries.length === 0) {
                    journalList.innerHTML = '<p class="empty-state">No journal entries yet. Start by creating your first entry.</p>';
                    return;
                }
                
                journalList.innerHTML = '';
                
                journalEntries.forEach((entry, index) => {
                    const entryDate = new Date(entry.date);
                    const formattedDate = entryDate.toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        year: 'numeric'
                    });
                    
                    const moodEmojis = ['', 'üòû', 'üôÅ', 'üòê', 'üôÇ', 'üòÑ'];
                    
                    const entryElement = document.createElement('div');
                    entryElement.className = 'journal-item';
                    entryElement.innerHTML = `
                        <div class="journal-item-header">
                            <span class="journal-date">${formattedDate}</span>
                            <span class="journal-mood">${moodEmojis[entry.mood]}</span>
                        </div>
                        <h3 class="journal-title">${entry.title}</h3>
                        <p class="journal-preview">${entry.content.substring(0, 100)}${entry.content.length > 100 ? '...' : ''}</p>
                        <div class="journal-actions">
                            <button class="btn-text view-entry" data-index="${index}">View</button>
                            <button class="btn-text delete-entry" data-index="${index}">Delete</button>
                        </div>
                    `;
                    
                    journalList.appendChild(entryElement);
                });
                
                // Add event listeners for view and delete buttons
                document.querySelectorAll('.view-entry').forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        viewJournalEntry(index);
                    });
                });
                
                document.querySelectorAll('.delete-entry').forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        if (confirm('Are you sure you want to delete this journal entry?')) {
                            deleteJournalEntry(index);
                        }
                    });
                });
            }
            
            // View journal entry
            function viewJournalEntry(index) {
                const journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                const entry = journalEntries[index];
                
                if (!entry) return;
                
                // Fill the form with the entry data
                document.getElementById('entry-date').value = entry.date;
                document.getElementById('entry-title').value = entry.title;
                document.getElementById('entry-content').value = entry.content;
                
                // Select the mood
                moodOptions.forEach(opt => opt.classList.remove('selected'));
                const moodOption = document.querySelector(`.mood-option[data-mood="${entry.mood}"]`);
                if (moodOption) {
                    moodOption.classList.add('selected');
                    selectedMood = entry.mood;
                }
                
                // Check the factors
                document.querySelectorAll('.factor-checkbox input').forEach(checkbox => {
                    checkbox.checked = entry.factors && entry.factors.includes(checkbox.id.replace('factor-', ''));
                });
                
                // Scroll to the journal form
                document.querySelector('.journal-entry-card').scrollIntoView({ behavior: 'smooth' });
            }
            
            // Delete journal entry
            function deleteJournalEntry(index) {
                const journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                
                if (index < 0 || index >= journalEntries.length) return;
                
                const deletedEntry = journalEntries.splice(index, 1)[0];
                localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
                
                // Update mood data if this was the only entry for that date
                const moodData = JSON.parse(localStorage.getItem('moodData')) || { dates: [], values: [] };
                const dateIndex = moodData.dates.indexOf(deletedEntry.date);
                
                // Check if there are other entries for the same date
                const otherEntriesForSameDate = journalEntries.some(entry => entry.date === deletedEntry.date);
                
                if (dateIndex !== -1 && !otherEntriesForSameDate) {
                    moodData.dates.splice(dateIndex, 1);
                    moodData.values.splice(dateIndex, 1);
                    localStorage.setItem('moodData', JSON.stringify(moodData));
                    
                    // Update mood history chart
                    moodHistoryChart.data.labels = moodData.dates;
                    moodHistoryChart.data.datasets[0].data = moodData.values;
                    moodHistoryChart.update();
                }
                
                // Update displays
                updateJournalList();
                updateCalendar();
            }
            
            // Initialize calendar
            let currentMonth = today.getMonth();
            let currentYear = today.getFullYear();
            
            function updateCalendar() {
                const calendarGrid = document.getElementById('calendar-grid');
                const monthYearHeader = document.getElementById('calendar-month');
                
                // Update month/year header
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                monthYearHeader.textContent = `${monthNames[currentMonth]} ${currentYear}`;
                
                // Clear previous calendar
                calendarGrid.innerHTML = '';
                
                // Add day headers
                const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                dayNames.forEach(day => {
                    const dayHeader = document.createElement('div');
                    dayHeader.className = 'calendar-day-header';
                    dayHeader.textContent = day;
                    calendarGrid.appendChild(dayHeader);
                });
                
                // Get first day of month and number of days
                const firstDay = new Date(currentYear, currentMonth, 1).getDay();
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                
                // Add empty cells for days before the first of the month
                for (let i = 0; i < firstDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'calendar-day empty';
                    calendarGrid.appendChild(emptyDay);
                }
                
                // Get mood data
                const moodData = JSON.parse(localStorage.getItem('moodData')) || { dates: [], values: [] };
                
                // Add days of the month
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = 'calendar-day';
                    
                    // Check if this day has a mood entry
                    const dateString = `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                    const moodIndex = moodData.dates.indexOf(dateString);
                    
                    if (moodIndex !== -1) {
                        const moodValue = moodData.values[moodIndex];
                        let moodColor;
                        
                        // Set color based on mood value
                        switch(moodValue) {
                            case 1: moodColor = '#e74c3c'; break; // Bad
                            case 2: moodColor = '#f39c12'; break; // Low
                            case 3: moodColor = '#f1c40f'; break; // Okay
                            case 4: moodColor = '#2ecc71'; break; // Good
                            case 5: moodColor = '#27ae60'; break; // Great
                        }
                        
                        dayCell.innerHTML = `
                            <span class="day-number">${day}</span>
                            <span class="mood-dot" style="background-color: ${moodColor}"></span>
                        `;
                        
                        // Add click event to view entries for this day
                        dayCell.addEventListener('click', function() {
                            const clickedDate = `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                            viewEntriesForDate(clickedDate);
                        });
                    } else {
                        dayCell.innerHTML = `<span class="day-number">${day}</span>`;
                    }
                    
                    // Highlight today
                    if (day === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
                        dayCell.classList.add('today');
                    }
                    
                    calendarGrid.appendChild(dayCell);
                }
            }
            
            // View entries for a specific date
            function viewEntriesForDate(date) {
                const journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                const entriesForDate = journalEntries.filter(entry => entry.date === date);
                
                if (entriesForDate.length === 0) {
                    alert(`No entries for ${new Date(date).toLocaleDateString()}`);
                    return;
                }
                
                // If there's only one entry, load it in the form
                if (entriesForDate.length === 1) {
                    const entryIndex = journalEntries.findIndex(entry => entry.date === date);
                    viewJournalEntry(entryIndex);
                    return;
                }
                
                // If there are multiple entries, let the user choose
                let entryOptions = '';
                entriesForDate.forEach((entry, i) => {
                    entryOptions += `${i + 1}. ${entry.title}\n`;
                });
                
                const selectedOption = prompt(`Multiple entries found for ${new Date(date).toLocaleDateString()}. Enter the number of the entry you want to view:\n\n${entryOptions}`);
                
                if (selectedOption && !isNaN(selectedOption) && selectedOption > 0 && selectedOption <= entriesForDate.length) {
                    const entryIndex = journalEntries.findIndex(entry => entry === entriesForDate[selectedOption - 1]);
                    viewJournalEntry(entryIndex);
                }
            }
            
            // Handle month navigation
            document.getElementById('prev-month').addEventListener('click', function() {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                updateCalendar();
            });
            
            document.getElementById('next-month').addEventListener('click', function() {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                updateCalendar();
            });
            
            // Initialize displays
            updateJournalList();
            updateCalendar();
        });
    </script>
</body>
</html>

